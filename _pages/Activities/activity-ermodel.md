---
layout: activity
permalink: /Activities/ERModel
title: "CS377: Database Design - Entity-Relational (ER) Data Model"
excerpt: "CS377: Database Design - Entity-Relational (ER)"

info:
  goals: 
    - To explain the various dependencies that exist among entites in an ER data model
    - To implement the various dependencies that exist among entites in an ER data model
    
  models:
    - model: |
        <img src="../images/Sql-ERModels.png" alt="Schema Definition Generated by eralchemy from the Sql-ERModels replit example">
      title: Kernels and Existence-Dependent (Weak) Entities
      questions:
        - "Why might the <code>DEPENDENTS</code> table be called a weak dependency?  Can it exist by itself?"
        - "What other weak dependencies do you see in the schema?"
        - "What <strong>independent entites</strong> (having no dependencies on other entity existence), or <strong>kernels</strong>, exist in this database?"
        - "Is every dependency a weak dependency?  What might an example be of a non-weak dependency?"
        - "On the <code>INSERT</code> line into <code>DEPENDENTCOVERAGE</code>, what does <code>last_insert_rowid()</code> refer to?  What is the corresponding ID from the lookup of last_insert_rowid(), and what are we doing with it?" 
        - "Why doesn't the <code>DEPENDENTCOVERAGE</code> table have an <code>EmployeeID</code> attribute (&quot;field&quot;), when it would be helpful with those subsequent insertions."
        - "Write a program to perform these insertions into this sqlite database, using a loop to iterate over all of an employee's dependents when inserting into <code>DEPENDENTCOVERAGE</code>."
        - "What would it mean if a foreign key did not exist in the primary table?  This is called a violation of <strong>referential integrity</strong>."
      embed: |
        <iframe height="400px" width="100%" src="https://repl.it/@BillJr99/Sql-ERModels?lite=true" scrolling="no" frameborder="no" allowtransparency="true" allowfullscreen="true" sandbox="allow-forms allow-pointer-lock allow-popups allow-same-origin allow-scripts allow-modals"></iframe> 
    - model: |
        <img src="../images/Sql-AggregationExample.png" alt="Schema Definition Generated by eralchemy from the Sql-AggregationExample replit example">
      title: Derived Entities
      questions:
        - "What are the kernels in this schema?"
        - "What is the purpose of the <code>ENROLLMENTS</code> table?  What does it connect?"
        - "<code>ENROLLMENTS</code> is an example of a <strong>derived entity</strong>; describe what you think this means in your own words."
        - "Using <a href=\"https://pypi.org/project/ERAlchemy/\">ERAlchemy</a>, generate a schema diagram from the example below."
      embed: |
        <iframe height="400px" width="100%" src="https://repl.it/@BillJr99/Sql-AggregationExample?lite=true" scrolling="no" frameborder="no" allowtransparency="true" allowfullscreen="true" sandbox="allow-forms allow-pointer-lock allow-popups allow-same-origin allow-scripts allow-modals"></iframe> 
    - model: |
        <a title="Pluke, Keiyakins, CC0, via Wikimedia Commons" href="https://commons.wikimedia.org/wiki/File:CPT-Databases-OnetoMany2.svg"><img width="256" alt="CPT-Databases-OnetoMany2" src="https://upload.wikimedia.org/wikipedia/commons/thumb/d/d7/CPT-Databases-OnetoMany2.svg/256px-CPT-Databases-OnetoMany2.svg.png"></a>
      title: Characteristic Entities
      questions:
        - "Design a relationship that features a kernel table for people with basic personal information, and a connection to zero or more email addresses.  You can't have infinitely many columns in your kernel table, so you will need a second table.  This relationship is called a <strong>characteristic entity</strong>."
        
tags:
  - er
  - modeling
  
---

## The Entity-Relational (ER) Model
The Entity-Relational (ER) model is a conceptual data model used to describe the structure of a database. It represents the entities, their attributes, and the relationships between entities. The ER model is widely used in database design and is essential for creating a well-structured and efficient database system.  The ER model was developed by Peter Chen in 1976 and has become a widely used technique in database development. It helps capture the entities (objects or concepts) in a system, their relationships, and the attributes of those entities.

Entities in an ER Model are represented as rectangles, and relationships between entities are represented as diamonds. Attributes of entities are depicted within the rectangles, and cardinality is indicated using lines and symbols.

The ER Model is helpful in clarifying the requirements of a system, identifying key entities and relationships, and providing a foundation for the creation of a physical database schema.

### Entity
In the ER model, an entity represents a real-world object, such as a person, place, event, or concept. Entities have attributes that describe their properties, and these attributes are used to store data in the database. Each entity is uniquely identified by a primary key, which is a unique identifier assigned to each entity instance.

Example of an Entity in Python:

```python
class Person:
    def __init__(self, id, name, age):
        self.id = id
        self.name = name
        self.age = age
```

### Relationship
Entities in the ER model can be related to each other through relationships. A relationship describes a connection between two or more entities and can have different types, such as one-to-one, one-to-many, or many-to-many. Relationships are important for capturing the dependencies between entities and ensuring data integrity in the database.

Example of a Relationship in Python:

```python
class Department:
    def __init__(self, id, name):
        self.id = id
        self.name = name
        self.employees = []
    
    def add_employee(self, employee):
        self.employees.append(employee)


class Employee:
    def __init__(self, id, name, department):
        self.id = id
        self.name = name
        self.department = department
```

### Attributes
Attributes are properties or characteristics that describe entities or relationships. Each attribute has a name and a data type, such as string, number, or date. Attributes can be classified into different types, including simple, composite, derived, and multivalued attributes. They play a crucial role in defining the structure and content of the database.

Example of Attributes in Python:

```python
class Product:
    def __init__(self, id, name, price):
        self.id = id
        self.name = name
        self.price = price
```

## ER Diagram
An ER diagram is a graphical representation of entities, relationships, and attributes in the ER model. It provides a visual representation of the database structure and helps in understanding the relationships between different entities. ER diagrams use different symbols and notations to represent entities, relationships, and attributes, making it easier to design and communicate database designs.

### Generating an ER Diagram with Python

Here is an example of using the ER Diagram Package in Python to create an ER diagram:

```python
from eralchemy import render_er
from sqlalchemy import MetaData, create_engine

metadata = MetaData()
engine = create_engine("sqlite:///database.db")
metadata.reflect(bind=engine)

render_er(metadata, 'output.png')
```

In the above code, we first import the necessary libraries and create a SQLAlchemy `MetaData` object. We then create a database engine using `create_engine` from SQLAlchemy, specifying the database URL. Next, we reflect the database structure using the `reflect` method of the `metadata` object, binding it to the engine. Finally, we use the `render_er` function from the ERAlchemy package to generate an ER diagram in PNG format.

Make sure to install the ERAlchemy package using `pip install eralchemy` before running the code.
